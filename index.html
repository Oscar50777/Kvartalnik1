<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–ö–≤–∞—Ä—Ç–∞–ª—å–Ω—ã–µ –∫–∞–ª–µ–Ω–¥–∞—Ä–∏</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 900px;
      margin: 0 auto;
      padding: 10px;
      background: #f8f9fa;
      font-size: 14px;
    }
    h1 {
      text-align: center;
      margin: 10px 0;
      font-size: 1.4em;
      color: #333;
    }
    .container {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }
    .box {
      background: white;
      padding: 12px;
      border-radius: 6px;
      box-shadow: 0 1px 4px rgba(0,0,0,0.1);
      margin-bottom: 8px;
    }
    .box h3 {
      margin: 0 0 8px 0;
      font-size: 1.1em;
      color: #444;
    }
    .btn {
      display: inline-block;
      padding: 5px 8px;
      margin: 2px;
      background: #f0f0f0;
      border: 1px solid #ddd;
      cursor: pointer;
      border-radius: 4px;
      font-size: 13px;
      text-align: center;
      min-width: 55px;
    }
    .btn.active {
      background: #007bff;
      color: white;
      border-color: #007bff;
      font-weight: bold;
    }
    .full-width {
      grid-column: 1 / -1;
      text-align: center;
    }
    .result, .history {
      grid-column: 1 / -1;
      padding: 12px;
      border-radius: 6px;
      margin-top: 10px;
    }
    .result {
      background: #e8f5e9;
      border: 1px solid #c8e6c9;
    }
    .history {
      background: #f0f8ff;
      border: 1px solid #bbdefb;
    }
    .desc {
      font-size: 12px;
      color: #555;
      margin-left: 10px;
      font-style: italic;
    }
    .error {
      color: red;
      font-size: 13px;
      margin: 8px 0;
    }
    button.action {
      width: 100%;
      padding: 12px;
      font-size: 16px;
      margin: 8px 0;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    button.green {
      background: #28a745;
      color: white;
    }
    button.purple {
      background: #6f42c1;
      color: white;
    }
    .note {
      grid-column: 1 / -1;
      font-size: 13px;
      color: #666;
      text-align: center;
      margin-top: 15px;
      font-style: italic;
    }
    a { color: #007bff; }

    /* –°—Ç–∏–ª–∏ –¥–ª—è –ø—Ä–∞–π—Å-—Ç–∞–±–ª–∏—Ü—ã */
    #price-table-container {
      display: none;
      padding: 20px;
      font-family: Arial, sans-serif;
      background: white;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    #price-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 15px;
    }
    #price-table th, #price-table td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: left;
      font-size: 13px;
    }
    #price-table th {
      background-color: #f0f0f0;
    }
    #price-table tr:nth-child(even) {
      background-color: #f9f9f9;
    }
  </style>
</head>
<body>
  <h1>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –∫–≤–∞—Ä—Ç–∞–ª—å–Ω—ã—Ö –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–π</h1>
  <div class="container">
    <!-- –õ–ï–í–´–ô –°–¢–û–õ–ë–ï–¶ -->
    <div class="box">
      <h3>–¢–∏–ø –ø–µ—á–∞—Ç–∏</h3>
      <div>
        <span onclick="setPrint('digital')" id="btn-digital" class="btn active" data-group="print" data-value="digital">–¶–∏—Ñ—Ä–∞</span>
        <span onclick="setPrint('offset')" id="btn-offset" class="btn" data-group="print" data-value="offset">–û—Ñ—Å–µ—Ç</span>
      </div>
    </div>
    <div class="box">
      <h3>–¢–∏—Ä–∞–∂</h3>
      <div id="tirazh-buttons"></div>
    </div>
    <div class="box">
      <h3>–†–∞–∑–º–µ—Ä</h3>
      <div>
        <span onclick="setSize('mini')" id="btn-mini" class="btn" data-group="size" data-value="mini">–ú–∏–Ω–∏</span>
        <span onclick="setSize('midi')" id="btn-midi" class="btn active" data-group="size" data-value="midi">–ú–∏–¥–∏</span>
        <span onclick="setSize('maxi')" id="btn-maxi" class="btn" data-group="size" data-value="maxi">–ú–∞–∫—Å–∏</span>
      </div>
    </div>
    <div class="box">
      <h3>–õ–∞–º–∏–Ω–∞—Ü–∏—è</h3>
      <div>
        <span onclick="setLam('none')" id="btn-lam-none" class="btn" data-group="lam" data-value="none">–ù–µ—Ç</span>
        <span onclick="setLam('1+0')" id="btn-lam-10" class="btn active" data-group="lam" data-value="1+0">1+0</span>
        <span onclick="setLam('1+1')" id="btn-lam-11" class="btn" data-group="lam" data-value="1+1">1+1</span>
        <span onclick="setLam('1+0_soft')" id="btn-lam-soft" class="btn" data-group="lam" data-value="1+0_soft">–°–æ—Ñ—Ç–∞—á</span>
      </div>
    </div>
    <div class="box">
      <h3>–¢–∏–ø –±–ª–æ–∫–∞</h3>
      <div>
        <span onclick="setBlock('matte')" id="btn-matte" class="btn active" data-group="block" data-value="matte">–ú–µ–ª–æ–≤–∞–Ω–Ω—ã–π</span>
        <span onclick="setBlock('metallic')" id="btn-metallic" class="btn" data-group="block" data-value="metallic">–ú–µ—Ç–∞–ª–ª.</span>
        <span onclick="setBlock('offset')" id="btn-offset-block" class="btn" data-group="block" data-value="offset">–û—Ñ—Å–µ—Ç</span>
      </div>
    </div>
    <!-- –ü–†–ê–í–´–ô –°–¢–û–õ–ë–ï–¶ -->
    <div class="box">
      <h3>–£–§-–ª–∞–∫</h3>
      <div>
        <span onclick="setUV('yes')" id="btn-uv-yes" class="btn" data-group="uv" data-value="yes">–î–∞</span>
        <span onclick="setUV('no')" id="btn-uv-no" class="btn active" data-group="uv" data-value="no">–ù–µ—Ç</span>
      </div>
    </div>
    <div class="box">
      <h3>–¢–∏—Å–Ω–µ–Ω–∏–µ</h3>
      <div>
        <span onclick="setFoil('cap')" id="btn-foil-cap" class="btn" data-group="foil" data-value="cap">–®–∞–ø–∫–∞</span>
        <span onclick="setFoil('cap+bottom')" id="btn-foil-bottom" class="btn" data-group="foil" data-value="cap+bottom">+–Ω–∏–∂–Ω–∏–π</span>
        <span onclick="setFoil('cap+3')" id="btn-foil-3" class="btn" data-group="foil" data-value="cap+3">+3</span>
        <span onclick="setFoil('none')" id="btn-foil-none" class="btn active" data-group="foil" data-value="none">–ù–µ—Ç</span>
      </div>
    </div>
    <div class="box">
      <h3>–ö–∞—à–∏—Ä–æ–≤–∫–∞</h3>
      <div>
        <span onclick="setKash('cap-no')" class="btn" data-group="kash" data-value="cap-no">–ë–µ–∑, —à–∞–ø–∫–∞</span>
        <span onclick="setKash('cap+bottom-no')" class="btn" data-group="kash" data-value="cap+bottom-no">–ë–µ–∑, +–Ω–∏–∑</span>
        <span onclick="setKash('cap+3-no')" class="btn" data-group="kash" data-value="cap+3-no">–ë–µ–∑, +3</span>
        <span onclick="setKash('cap-yes')" class="btn" data-group="kash" data-value="cap-yes">–°, —à–∞–ø–∫–∞</span>
        <span onclick="setKash('cap+bottom-yes')" class="btn" data-group="kash" data-value="cap+bottom-yes">–°, +–Ω–∏–∑</span>
        <span onclick="setKash('cap+3-yes')" class="btn" data-group="kash" data-value="cap+3-yes">–°, +3</span>
        <span onclick="setKash('none')" id="btn-kash-none" class="btn active" data-group="kash" data-value="none">–ù–µ—Ç</span>
      </div>
    </div>
    <div class="box">
      <h3>–ù–∞—Ü–µ–Ω–∫–∞</h3>
      <div>
        <span onclick="setMarkup('20')" id="btn-markup-20" class="btn active" data-group="markup" data-value="20">+20%</span>
        <span onclick="setMarkup('5000')" id="btn-markup-5k" class="btn" data-group="markup" data-value="5000">+5000</span>
      </div>
    </div>
    <!-- –ö–ù–û–ü–ö–ò -->
    <div class="full-width">
      <button onclick="calculate()" class="action green">‚úÖ –†–∞—Å—Å—á–∏—Ç–∞—Ç—å</button>
      <button onclick="window.open('https://www.polimat.ru', '_blank')" class="action purple">üß© –ü–æ—Å—á–∏—Ç–∞—Ç—å –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –±–ª–æ–∫</button>
      <button onclick="generatePriceList()" class="action" style="background:#ffc107; color:#333;">üìä –°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∞–π—Å</button>
    </div>
    <!-- –û–®–ò–ë–ö–ê -->
    <div class="full-width">
      <p id="lam-error" class="error" style="display:none;">
        ‚ö†Ô∏è –ö–∞—à–∏—Ä–æ–≤–∫–∞ —Ç—Ä–µ–±—É–µ—Ç –ª–∞–º–∏–Ω–∞—Ü–∏–∏! –í—ã–±—Ä–∞–Ω–æ: 1+0
      </p>
    </div>
    <!-- –†–ï–ó–£–õ–¨–¢–ê–¢ -->
    <div id="result" class="result" style="display:none;">
      <p><strong>–û–ø–∏—Å–∞–Ω–∏–µ:</strong> <span id="desc"></span></p>
      <p>–¶–µ–Ω–∞ –∑–∞ —à—Ç (–±–µ–∑): <strong><span id="ppu"></span> ‚ÇΩ</strong></p>
      <p>–ò—Ç–æ–≥–æ (–±–µ–∑): <strong><span id="total"></span> ‚ÇΩ</strong></p>
      <p>–¶–µ–Ω–∞ –∑–∞ —à—Ç (—Å): <strong><span id="ppu-final"></span> ‚ÇΩ</strong></p>
      <p>–ò—Ç–æ–≥–æ (—Å): <strong><span id="total-final"></span> ‚ÇΩ</strong></p>
      <button onclick="copyResult()" style="width:100%; padding:8px; background:#007bff; color:white; border:none; margin-top:8px;">üìã –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∏—Ç–æ–≥</button>
    </div>
    <!-- –ò–°–¢–û–†–ò–Ø -->
    <div id="history" class="history" style="display:none;">
      <h3>–ò—Å—Ç–æ—Ä–∏—è —Ä–∞—Å—á—ë—Ç–æ–≤</h3>
      <ol id="history-list"></ol>
    </div>
    <!-- –ü–†–ò–ú–ï–ß–ê–ù–ò–ï -->
    <p class="note">
      * –ë–ª–æ–∫ –∏–∑ <a href="https://www.polimat.ru" target="_blank">www.polimat.ru</a>. –ú–µ—Ç–∞–ª–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –±–ª–æ–∫–∏ +20 —Ä—É–±/—à—Ç. –û—Ñ—Å–µ—Ç–Ω—ã–µ –±–ª–æ–∫–∏ -5 —Ä—É–±/—à—Ç. –ú–∞–≥–Ω–∏—Ç–Ω—ã–π –∫—É—Ä—Å–æ—Ä +140 —Ä—É–±/—à—Ç
    </p>
  </div>

  <!-- –°–ö–†–´–¢–ê–Ø –¢–ê–ë–õ–ò–¶–ê –î–õ–Ø –ü–†–ê–ô–°–ê -->
  <div id="price-table-container">
    <h2>–ü—Ä–∞–π—Å-–ª–∏—Å—Ç –Ω–∞ –∫–≤–∞—Ä—Ç–∞–ª—å–Ω—ã–µ –∫–∞–ª–µ–Ω–¥–∞—Ä–∏</h2>
    <p><em>–ë–ª–æ–∫ ‚Äî –º–µ–ª–æ–≤–∞–Ω–Ω—ã–π, –ª–∞–º–∏–Ω–∞—Ü–∏—è ‚Äî 1+0</em></p>
    <table id="price-table" border="1" cellpadding="6" cellspacing="0" style="width:100%; border-collapse:collapse;">
      <thead>
        <tr style="background:#f0f0f0;">
          <th>–¢–∏–ø –ø–µ—á–∞—Ç–∏</th>
          <th>–†–∞–∑–º–µ—Ä</th>
          <th>–¢–∏—Ä–∞–∂</th>
          <th>–¶–µ–Ω–∞ –∑–∞ —à—Ç—É–∫—É (–±–µ–∑ –Ω–∞—Ü–µ–Ω–∫–∏)</th>
          <th>–¶–µ–Ω–∞ –∑–∞ —à—Ç—É–∫—É (—Å –Ω–∞—Ü–µ–Ω–∫–æ–π)</th>
        </tr>
      </thead>
      <tbody id="price-table-body"></tbody>
    </table>
    <p style="margin-top:20px;"><em>* –ú–µ—Ç–∞–ª–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –±–ª–æ–∫–∏ +20 ‚ÇΩ/—à—Ç, –æ—Ñ—Å–µ—Ç–Ω—ã–µ ‚Äî -5 ‚ÇΩ/—à—Ç. –ú–∞–≥–Ω–∏—Ç–Ω—ã–π –∫—É—Ä—Å–æ—Ä +140 ‚ÇΩ/—à—Ç</em></p>
  </div>

  <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –¥–ª—è PDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

  <script>
    // ====== –î–ê–ù–ù–´–ï ======
    const digitalPrices = [ [25,285,355,535], [50,277,305,520], [100,228,270,420], [150,223,260,412], [200,212,255,390], [250,198,250,360], [300,194,248,353] ];
    const offsetPrices = [ [400,163,208,287], [500,156,200,272], [600,151,195,262], [700,148,192,256], [800,145,189,250], [1000,142,185,243], [1500,137,180,233], [2000,134,177,229] ];
    const lamAdd = {
      '1+0': {mini:15, midi:20, maxi:30},
      '1+1': {mini:30, midi:40, maxi:60},
      '1+0_soft': {mini:20, midi:25, maxi:40}
    };

    // ====== –°–û–°–¢–û–Ø–ù–ò–ï ======
    let state = {
      printType: 'digital',
      tirazh: 100,
      size: 'midi',
      lam: '1+0',
      block: 'matte',
      uv: 'no',
      foil: 'none',
      kash: 'none',
      markup: '20'
    };

    // ====== –£–°–¢–ê–ù–û–í–ö–ê –ê–ö–¢–ò–í–ù–´–• –ö–ù–û–ü–û–ö ======
    function setActive(group, value) {
      document.querySelectorAll(`.btn[data-group="${group}"]`).forEach(btn => {
        btn.classList.remove('active');
      });
      const btn = document.querySelector(`.btn[data-group="${group}"][data-value="${value}"]`);
      if (btn) btn.classList.add('active');
    }

    // ====== –ü–ï–†–ï–ö–õ–Æ–ß–ï–ù–ò–ï ======
    function setPrint(type) {
      state.printType = type;
      setActive('print', type);
      updateTirazhButtons();
    }
    function setSize(s) {
      state.size = s;
      setActive('size', s);
    }
    function setLam(l) {
      state.lam = l;
      setActive('lam', l);
    }
    function setBlock(b) {
      state.block = b;
      setActive('block', b);
    }
    function setUV(u) {
      state.uv = u;
      setActive('uv', u);
    }
    function setFoil(f) {
      state.foil = f;
      setActive('foil', f);
    }
    function setKash(k) {
      state.kash = k;
      setActive('kash', k);
    }
    function setMarkup(m) {
      state.markup = m;
      setActive('markup', m);
    }

    // ====== –¢–ò–†–ê–ñ–ò ======
    function updateTirazhButtons() {
      const container = document.getElementById('tirazh-buttons');
      container.innerHTML = '';
      const list = state.printType === 'digital' ? [25,50,100,150,200,250,300] : [400,500,600,700,800,1000,1500,2000];
      list.forEach(t => {
        const btn = document.createElement('span');
        btn.className = 'btn';
        btn.textContent = t;
        btn.setAttribute('data-group', 'tirazh');
        btn.setAttribute('data-value', t);
        btn.onclick = () => {
          state.tirazh = t;
          setActive('tirazh', t);
        };
        container.appendChild(btn);
      });
      if (list.includes(state.tirazh)) {
        setActive('tirazh', state.tirazh);
      } else {
        state.tirazh = list[0];
        setActive('tirazh', list[0]);
      }
    }
    updateTirazhButtons();

    // ====== –ò–°–¢–û–†–ò–Ø ======
    const historyData = [];

    // ====== –†–ê–°–ß–Å–¢ ======
    function calculate() {
      const t = state.tirazh;
      const sizeIdx = {mini:0, midi:1, maxi:2}[state.size];
      const prices = state.printType === 'digital' ? digitalPrices : offsetPrices;
      const row = prices.find(r => r[0] === t);
      if (!row) {
        alert("–ù–µ –Ω–∞–π–¥–µ–Ω–∞ —Ü–µ–Ω–∞ –¥–ª—è —Ç–∏—Ä–∞–∂–∞ " + t);
        return;
      }
      let pricePerUnit = row[sizeIdx + 1];
      if (state.lam !== 'none' && lamAdd[state.lam]) {
        pricePerUnit += lamAdd[state.lam][state.size];
      }
      if (state.block === 'metallic') pricePerUnit += 20;
      if (state.block === 'offset') pricePerUnit -= 5;

      document.getElementById('lam-error').style.display = 'none';
      if (state.kash !== 'none' && state.lam === 'none') {
        state.lam = '1+0';
        pricePerUnit += lamAdd['1+0'][state.size];
        setLam('1+0');
        document.getElementById('lam-error').style.display = 'block';
      }

      if (state.uv === 'yes') pricePerUnit += 7000/t + 10;
      if (state.foil === 'cap') pricePerUnit += 8500/t + 10;
      if (state.foil === 'cap+bottom') pricePerUnit += 15000/t + 20;
      if (state.foil === 'cap+3') pricePerUnit += 30000/t + 40;

      if (state.kash !== 'none') {
        const base = 5000/t;
        if (state.kash === 'cap-no') pricePerUnit += base + 25;
        if (state.kash === 'cap+bottom-no') pricePerUnit += base + 50;
        if (state.kash === 'cap+3-no') pricePerUnit += base + 90;
        if (state.kash === 'cap-yes') pricePerUnit += base + 115;
        if (state.kash === 'cap+bottom-yes') pricePerUnit += base + 230;
        if (state.kash === 'cap+3-yes') pricePerUnit += base + 460;
      }

      const totalBase = pricePerUnit * t;
      let totalFinal = totalBase;
      if (state.markup === '20') totalFinal *= 1.2;
      if (state.markup === '5000') totalFinal += 5000;
      const ppuFinal = Math.round(totalFinal / t);
      const totalFinalRounded = Math.round(totalFinal);

      const sizeNames = {mini:'–ú–∏–Ω–∏', midi:'–ú–∏–¥–∏', maxi:'–ú–∞–∫—Å–∏'};
      const blockNames = {matte:'–º–µ–ª–æ–≤–∞–Ω–Ω—ã–π', metallic:'–º–µ—Ç–∞–ª–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π', offset:'–æ—Ñ—Å–µ—Ç–Ω—ã–π'};
      const print = state.printType === 'offset' ? '4+0' : '4+0';
      const options = [];
      if (state.lam !== 'none') options.push(`–ª–∞–º. ${state.lam}`);
      options.push(`–±–ª–æ–∫ ${blockNames[state.block]}`);
      if (state.foil !== 'none') options.push('—Ç–∏—Å–Ω–µ–Ω–∏–µ');
      if (state.kash !== 'none') options.push('–∫–∞—à–∏—Ä–æ–≤–∫–∞');
      if (state.uv === 'yes') options.push('–£–§-–ª–∞–∫');
      const description = `–ö–∞–ª–µ–Ω–¥–∞—Ä—å ${sizeNames[state.size]}, ${print}, –∫–∞—Ä—Ç–æ–Ω 300 –≥, ${options.join(', ')}`;

      document.getElementById('desc').textContent = description;
      document.getElementById('ppu').textContent = Math.round(pricePerUnit).toLocaleString();
      document.getElementById('total').textContent = Math.round(totalBase).toLocaleString();
      document.getElementById('ppu-final').textContent = ppuFinal.toLocaleString();
      document.getElementById('total-final').textContent = totalFinalRounded.toLocaleString();
      document.getElementById('result').style.display = 'block';

      historyData.push({tirazh: t, total: totalFinalRounded, desc: description});
      const list = document.getElementById('history-list');
      list.innerHTML = '';
      historyData.forEach((item, i) => {
        const li = document.createElement('li');
        li.innerHTML = `<strong>${item.tirazh} —à—Ç: ${item.total.toLocaleString()} ‚ÇΩ</strong>`;
        list.appendChild(li);
        const d = document.createElement('div');
        d.className = 'desc';
        d.textContent = item.desc;
        list.appendChild(d);
      });
      document.getElementById('history').style.display = 'block';

      window.copyText = `–¶–µ–Ω–∞ –∑–∞ —à—Ç—É–∫—É: ${ppuFinal.toLocaleString()} ‚ÇΩ
–û–±—â–∞—è —Å—É–º–º–∞: ${totalFinalRounded.toLocaleString()} ‚ÇΩ
* –ë–ª–æ–∫–∏ –ø–æ–ª–∏–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –º–µ–ª–æ–≤–∞–Ω–Ω—ã–µ. –ú–µ—Ç–∞–ª–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –±–ª–æ–∫–∏ +20 —Ä—É–±/—à—Ç. –û—Ñ—Å–µ—Ç–Ω—ã–µ –±–ª–æ–∫–∏ -5 —Ä—É–±/—à—Ç. –ú–∞–≥–Ω–∏—Ç–Ω—ã–π –∫—É—Ä—Å–æ—Ä +140 —Ä—É–±/—à—Ç`;
    }

    function copyResult() {
      if (!window.copyText) {
        alert("–°–Ω–∞—á–∞–ª–∞ –Ω–∞–∂–º–∏—Ç–µ '–†–∞—Å—Å—á–∏—Ç–∞—Ç—å'");
        return;
      }
      const text = window.copyText;
      const ta = document.createElement('textarea');
      ta.value = text;
      ta.style.position = 'fixed';
      ta.style.opacity = '0';
      document.body.appendChild(ta);
      ta.select();
      try {
        document.execCommand('copy');
        alert("‚úÖ –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ");
      } catch (e) {
        prompt("–°–∫–æ–ø–∏—Ä—É–π—Ç–µ:", text);
      }
      document.body.removeChild(ta);
    }

    // ====== –ì–ï–ù–ï–†–ê–¶–ò–Ø –ü–†–ê–ô–°–ê –í PDF ======
    async function generatePriceList() {
      // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫
      if (typeof html2canvas === 'undefined' || typeof window.jspdf === 'undefined') {
        alert('–ë–∏–±–ª–∏–æ—Ç–µ–∫–∏ PDF –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã. –ü–æ–¥–æ–∂–¥–∏—Ç–µ...');
        return;
      }

      const markupInput = prompt('–í–≤–µ–¥–∏—Ç–µ –Ω–∞—Ü–µ–Ω–∫—É:\n- –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö: 10, 20, 50 –∏ —Ç.–¥.\n- –∏–ª–∏ "5000" –¥–ª—è +5000 ‚ÇΩ');
      if (!markupInput) return;

      let markupPercent = null;
      let markupFixed = false;

      if (markupInput.trim() === '5000') {
        markupFixed = true;
      } else {
        markupPercent = parseFloat(markupInput);
        if (isNaN(markupPercent) || markupPercent < 0) {
          alert('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —á–∏—Å–ª–æ: –Ω–∞–ø—Ä–∏–º–µ—Ä, 20 –∏–ª–∏ "5000"');
          return;
        }
      }

      const container = document.getElementById('price-table-container');
      const tableBody = document.getElementById('price-table-body');
      tableBody.innerHTML = '';

      const sizes = ['mini', 'midi', 'maxi'];
      const sizeNames = { mini: '–ú–∏–Ω–∏', midi: '–ú–∏–¥–∏', maxi: '–ú–∞–∫—Å–∏' };
      const printTypes = [
        { type: 'digital', name: '–¶–∏—Ñ—Ä–æ–≤–∞—è', prices: digitalPrices },
        { type: 'offset', name: '–û—Ñ—Å–µ—Ç–Ω–∞—è', prices: offsetPrices }
      ];
      const lamAddValue = lamAdd['1+0']; // –õ–∞–º–∏–Ω–∞—Ü–∏—è 1+0

      printTypes.forEach(print => {
        print.prices.forEach(row => {
          const tirazh = row[0];
          sizes.forEach((size, idx) => {
            let pricePerUnit = row[idx + 1];
            pricePerUnit += lamAddValue[size];

            const totalBase = pricePerUnit * tirazh;
            let priceWithMarkup = totalBase;

            if (markupFixed) {
              priceWithMarkup += 5000;
            } else {
              priceWithMarkup *= (1 + markupPercent / 100);
            }
            const ppuWithMarkup = Math.round(priceWithMarkup / tirazh);

            const tr = document.createElement('tr');
            tr.innerHTML = `
              <td>${print.name}</td>
              <td>${sizeNames[size]}</td>
              <td>${tirazh}</td>
              <td>${Math.round(pricePerUnit)} ‚ÇΩ</td>
              <td>${ppuWithMarkup} ‚ÇΩ</td>
            `;
            tableBody.appendChild(tr);
          });
        });
      });

      try {
        // –ñ–¥—ë–º –ø–æ–ª–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
        const canvas = await html2canvas(container, { scale: 2, useCORS: true, backgroundColor: '#ffffff' });
        const imgData = canvas.toDataURL('image/jpeg', 0.9);

        const { jsPDF } = window.jspdf;
        const pdf = new jsPDF('p', 'mm', 'a4');
        const pdfWithMarkup = new jsPDF('p', 'mm', 'a4');

        const pageWidth = pdf.internal.pageSize.getWidth();
        const imgWidth = pageWidth - 20;
        const imgHeight = (canvas.height * imgWidth) / canvas.width;

        // PDF –±–µ–∑ –Ω–∞—Ü–µ–Ω–∫–∏
        pdf.addImage(imgData, 'JPEG', 10, 20, imgWidth, imgHeight);
        pdf.setFontSize(12);
        pdf.text('–ü—Ä–∞–π—Å –±–µ–∑ –Ω–∞—Ü–µ–Ω–∫–∏', 10, 10);
        pdf.save('–ø—Ä–∞–π—Å_–±–µ–∑_–Ω–∞—Ü–µ–Ω–∫–∏.pdf');

        // PDF —Å –Ω–∞—Ü–µ–Ω–∫–æ–π
        const markupLabel = markupFixed ? '+5000 ‚ÇΩ' : `+${markupPercent}%`;
        pdfWithMarkup.addImage(imgData, 'JPEG', 10, 20, imgWidth, imgHeight);
        pdfWithMarkup.setFontSize(12);
        pdfWithMarkup.text(`–ü—Ä–∞–π—Å —Å –Ω–∞—Ü–µ–Ω–∫–æ–π ${markupLabel}`, 10, 10);
        pdfWithMarkup.save(`–ø—Ä–∞–π—Å_—Å_–Ω–∞—Ü–µ–Ω–∫–æ–π_${markupLabel.replace(/[^\w]/g, '_')}.pdf`);

      } catch (e) {
        console.error('–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ PDF:', e);
        alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ PDF. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.');
      }
    }
  </script>
</body>
</html>
